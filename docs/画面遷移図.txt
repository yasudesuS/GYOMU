================================================================================
                            画面遷移図
                     （views.pyのsuccess_urlと処理フローに基づく）
================================================================================

【基本画面遷移】

ログイン画面 → 掲示板（トップページ）
           ↓
        各メニューへ遷移

================================================================================

【掲示板機能の画面遷移】

掲示板（/top_page/）
  ↓
  詳細リンク
  ↓
掲示板詳細（/info_detail/<id>/）
  ↓ 編集ボタン
掲示板更新（/info_update/<id>/）
  ↓ 保存成功
掲示板（/top_page/） ← success_url

掲示板詳細（/info_detail/<id>/）
  ↓ 削除ボタン
掲示板削除（/info_delete/<id>/）
  ↓ 削除実行
掲示板（/top_page/） ← success_url

掲示板（/top_page/）
  ↓ ナビメニュー「掲示板入力」
掲示板入力（/info_create/）
  ↓ 保存成功
掲示板（/top_page/） ← success_url

掲示板詳細（/info_detail/<id>/）
  ↓ 確認ボタン
掲示板確認（/info_confirm/<id>/）
  ↓ 確認完了
掲示板（/top_page/） ← success_url

================================================================================

【申請ワークフロー画面遷移】

申請入力（/request_create/）
  ↓ 申請送信成功
申請一覧（/request_list/） ← success_url

申請一覧（/request_list/）
  ↓ 詳細リンク
申請詳細（/request_detail/<id>/）
  ↓ 編集ボタン
申請更新（/request_update/<id>/）
  ↓ 更新成功
申請一覧（/request_list/） ← success_url

申請詳細（/request_detail/<id>/）
  ↓ 削除ボタン
申請削除（/request_delete/<id>/）
  ↓ 削除実行
申請一覧（/request_list/） ← success_url

申請検索（/request_list2/）
  ↓ 検索実行
申請検索（/request_list2/） ← 同画面で結果表示

================================================================================

【承認ワークフロー画面遷移】

承認一覧（/approval_list/）
  ↓ 詳細リンク
承認詳細（/approval_detail/<id>/）
  ↓ 承認ボタン
承認更新（/approval_update/<id>/）
  ↓ 承認処理完了
承認一覧（/approval_list/） ← success_url

最終承認一覧（/last_approval_list/）
  ↓ 詳細リンク
最終承認詳細（/last_approval_detail/<id>/）
  ↓ 最終承認ボタン
最終承認更新（/last_approval_update/<id>/）
  ↓ 最終承認処理完了
最終承認一覧（/last_approval_list/） ← success_url

================================================================================

【勤怠申請ワークフロー画面遷移】

勤怠入力（/offday_create/）
  ↓ 申請送信成功
勤怠一覧（/offday_list/） ← success_url

勤怠一覧（/offday_list/）
  ↓ 詳細リンク
勤怠詳細（/offday_detail/<id>/）
  ↓ 削除ボタン
勤怠削除（/offday_delete/<id>/）
  ↓ 削除実行
勤怠一覧（/offday_list/） ← success_url

勤怠検索（/offday_list2/）
  ↓ 検索実行
勤怠検索（/offday_list2/） ← 同画面で結果表示

勤怠CSV取込（/import_offday_csv/）
  ↓ CSV処理成功
勤怠CSV取込（/import_offday_csv/） ← 同画面でメッセージ表示

================================================================================

【勤怠承認ワークフロー画面遷移】

勤怠承認一覧（/ap_offday_list/）
  ↓ 承認リンク
勤怠承認更新（/ap_offday_update/<id>/）
  ↓ 承認処理完了
勤怠承認一覧（/ap_offday_list/） ← success_url

勤怠最終承認一覧（/ls_offday_list/）
  ↓ 最終承認リンク
勤怠最終承認更新（/ls_offday_update/<id>/）
  ↓ 最終承認処理完了
勤怠最終承認一覧（/ls_offday_list/） ← success_url

勤怠一括更新（/bulk_update_offday/）
  ↓ 一括処理完了
勤怠一括更新（/bulk_update_offday/） ← 同画面で結果表示

勤怠一括更新2（/bulk_update_offday2/）
  ↓ 一括処理完了
勤怠一括更新2（/bulk_update_offday2/） ← 同画面で結果表示

================================================================================

【改善提案ワークフロー画面遷移】

改善提案入力（/kaizen/）
  ↓ 提案送信成功
メッセージ画面（/message/） ← success_url

改善提案検索（/improve_list2/）
  ↓ 詳細リンク
改善提案詳細（/improve_detail/<id>/）
  ↓ 回答ボタン
改善提案更新（回答用）（/improve_update1/<id>/）
  ↓ 回答完了
改善提案検索（/improve_list2/） ← success_url

改善提案詳細（/improve_detail/<id>/）
  ↓ 編集ボタン
改善提案更新（編集用）（/improve_update2/<id>/）
  ↓ 編集完了
改善提案検索（/improve_list2/） ← success_url

改善提案一覧（/improve_list/）
  ↓ 検索実行
改善提案一覧（/improve_list/） ← 同画面で結果表示

================================================================================

【その他機能の画面遷移】

社長宛意見箱（/iken/）
  ↓ 送信成功
メッセージ画面（/message/） ← renderで直接表示

スケジュール関連画面（会社カレンダー、応接室、食堂）
  ↓ 各画面から
各画面（/calendar/, /meetingroom/, /diningroom/） ← 独立画面

事務検索（勤怠検索、申請検索）
  ↓ 検索実行
各検索画面（/offday_list3/, /request_list3/） ← 同画面で結果表示

ログアウト（/logout/）
  ↓ ログアウト処理
ログイン画面 ← redirect

================================================================================

【権限による画面制限】

従業員ID=20の場合:
- 入力系機能 → 掲示板（/top_page/）へリダイレクト
- 申請・勤怠申請一覧 → 掲示板（/top_page/）へリダイレクト

スタッフユーザーでない場合:
- 勤怠検索（/offday_list3/） → 掲示板（/top_page/）へリダイレクト

スーパーユーザーでない場合:
- 最終承認一覧 → 掲示板（/top_page/）へリダイレクト

================================================================================

【承認ワークフローの特殊遷移】

申請作成時の自動振り分け:
申請入力（/request_create/）
  ↓ 中間承認者が設定されている場合
  → 中間承認者にメール通知（承認詳細へのリンク）
  ↓ 中間承認者が設定されていない場合
  → 最終承認者にメール通知（最終承認詳細へのリンク）

勤怠申請作成時の自動振り分け:
勤怠入力（/offday_create/）
  ↓ 中間承認者が設定されている場合
  → 中間承認者にメール通知（勤怠承認一覧へのリンク）
  ↓ 中間承認者が設定されていない場合
  → 最終承認者にメール通知（勤怠最終承認一覧へのリンク）

承認完了時の次段階通知:
承認更新（/approval_update/<id>/）
  ↓ 承認完了
  → 最終承認者にメール通知（最終承認詳細へのリンク）

勤怠承認完了時の次段階通知:
勤怠承認更新（/ap_offday_update/<id>/）
  ↓ 承認完了
  → 最終承認者にメール通知（勤怠最終承認一覧へのリンク）

================================================================================

【エラー時の画面遷移】

認証エラー:
全ての画面（認証必須）
  ↓ 未認証の場合
ログイン画面（/accounts/login/）

権限エラー:
各制限画面
  ↓ 権限不足の場合
掲示板（/top_page/）

CSVエラー:
勤怠CSV取込（/import_offday_csv/）
  ↓ エラー発生
勤怠CSV取込（/import_offday_csv/） ← エラーメッセージと共に再表示

================================================================================ 